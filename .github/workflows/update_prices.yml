name: Update MWI Market Data

on:
  schedule:
    - cron: '*/30 * * * *' 
  workflow_dispatch:      

jobs:
  update-data:
    runs-on: ubuntu-latest
    steps:
      - name: Checkout code
        uses: actions/checkout@v3

      - name: Fetch Market Data
        run: |
          # ä½¿ç”¨ -L è·Ÿéš¨é‡å®šå‘ï¼Œä¸¦åŠ å…¥éš¨æ©Ÿåƒæ•¸é˜²æ­¢å¿«å–
          curl -L -H "Cache-Control: no-cache" -H "User-Agent: Mozilla/5.0" "https://www.milkywayidle.com/game_data/marketplace.json?t=$(date +%s)" -o data.json
      - name: Commit and Push
        run: |
          git config --global user.name "GitHub Action"
          git config --global user.email "action@github.com"
          git add data.json
          # åŠ ä¸Šæ™‚é–“æˆ³è¨˜ç¢ºä¿æ¯æ¬¡ Commit å…§å®¹éƒ½ä¸åŒ
          git commit -m "ğŸš€ è‡ªå‹•æ›´æ–°å¸‚å ´å–®åƒ¹: $(date)" || exit 0
          git push
